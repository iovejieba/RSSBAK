name: Simple RSS Backup

on:
  schedule:
    - cron: '0 */2 * * *'  # æ¯2å°æ—¶ä¸€æ¬¡
  workflow_dispatch:

jobs:
  backup:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Fetch RSS
        run: |
          # åˆ›å»ºç›®å½•
          mkdir -p feeds
          
          # RSSæºï¼ˆä¿®æ”¹è¿™é‡Œï¼‰
          RSS_URL="https://rsshub.995299.xyz:8443/javbees/new"
          
          # æŠ“å–å†…å®¹
          curl -s -L "$RSS_URL" -o feeds/rss_feed.xml
          
          # æ·»åŠ æ—¶é—´æˆ³
          echo "<!-- Last fetched: $(date) -->" >> feeds/rss_feed.xml
          
          # æ˜¾ç¤ºä¿¡æ¯
          echo "æ–‡ä»¶å·²ä¿å­˜åˆ°: feeds/rss_feed.xml"
          echo "æ–‡ä»¶å¤§å°: $(wc -l < feeds/rss_feed.xml) è¡Œ"
      
      - name: Commit if changed
        run: |
          git config user.email "actions@github.com"
          git config user.name "GitHub Actions"
          
          # æ£€æŸ¥æ˜¯å¦æœ‰å˜åŒ–
          if git diff --quiet; then
            echo "æ²¡æœ‰æ›´æ”¹"
          else
            git add feeds/
            git commit -m "ğŸ“° RSSå¤‡ä»½ $(date +'%Y-%m-%d %H:%M')"
            git push
          fi
